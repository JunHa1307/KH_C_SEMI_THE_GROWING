<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<entry key="selectAlbumList">
		SELECT BOARD_NO, BOARD_TITLE, CREATE_DATE, FILE_PATH || CHANGE_NAME AS TITLEIMG
		FROM BOARD B
		JOIN ATTACHMENT ON(BOARD_NO = REF_BNO)
		WHERE BOARD_TYPE = 3 
		AND B.REF_CNO=?
		AND B.STATUS = 'Y'
		AND FILE_LEVEL = 1
		ORDER BY CREATE_DATE DESC
	</entry>

	<entry key="insertAlbumBoard">
		INSERT INTO BOARD(BOARD_NO, BOARD_TYPE, BOARD_TITLE, BOARD_CONTENT, REF_UNO, REF_CNO )
		VALUES (SEQ_BNO.NEXTVAL, ?, ? ,? ,?,?)
	</entry>


	<entry key="insertAttachmentList">
		INSERT INTO ATTACHMENT(FILE_NO, REF_BNO, ORIGIN_NAME, CHANGE_NAME, FILE_PATH, FILE_LEVEL)
		VALUES (SEQ_ANO.NEXTVAL, SEQ_BNO.CURRVAL, ?,?,?,?)
	</entry>

	<entry key="selectAttachList">
		SELECT FILE_NO, ORIGIN_NAME, CHANGE_NAME, FILE_PATH
		FROM ATTACHMENT
		JOIN BOARD B ON (BOARD_NO = REF_BNO)
		WHERE B.REF_CNO = ?
		ORDER BY UPLOAD_DATE DESC
	</entry>

	<entry key="selectListCount">
		SELECT COUNT(*) AS COUNT
		FROM BOARD
		WHERE STATUS = 'Y'
		  AND BOARD_TYPE = 4
	</entry>
	
	<entry key="selectList">
		SELECT * 	
		FROM(
				SELECT ROWNUM RNUM , A.*
				FROM (
					SELECT
					       BOARD_NO,
					       USER_ID,
					       BOARD_TITLE,
					       CREATE_DATE,
					       REF_CNO
					FROM BOARD B
					JOIN MEMBER ON (REF_UNO = USER_NO)
					WHERE BOARD_TYPE = 4
					  AND B.STATUS = 'Y'
					ORDER BY BOARD_NO DESC
				) A
			)
		WHERE RNUM BETWEEN ? AND ?
	</entry>
	
	<entry key="increaseCount">
		UPDATE BOARD
		SET BOARD_COUNT = BOARD_COUNT +1
		WHERE BOARD_NO = ? 
		  AND STATUS = 'Y'
	</entry>
	
	<entry key="selectBoard">
		SELECT 
			BOARD_NO,
			BOARD_TYPE,
			BOARD_TITLE,
			USER_ID,
			CREATE_DATE,
			BOARD_CONTENT
		FROM BOARD B
		JOIN MEMBER ON (REF_UNO = USER_NO)
		WHERE BOARD_NO = ?
		  AND B.STATUS = 'Y'
	</entry>
	
	<entry key="selectAttachment">
		SELECT 
			FILE_NO ,
			ORIGIN_NAME,
			CHANGE_NAME,
			FILE_PATH,
			NVL(FILE_LEVEL , 0) AS FILE_LEVEL
		FROM ATTACHMENT
		WHERE REF_BNO = ?
		ORDER BY FILE_LEVEL
	</entry>
	
	<entry key="updateBoard">
		UPDATE BOARD
		SET 
			BOARD_TITLE = ?,
			BOARD_CONTENT =?
		WHERE BOARD_NO = ?
	</entry>
	
	<entry key="updateAttachment">
		UPDATE ATTACHMENT
		SET ORIGIN_NAME = ? ,
		    CHANGE_NAME = ? ,
		    FILE_PATH   = ? ,
			UPLOAD_DATE = SYSDATE
		WHERE FILE_NO = ?
	</entry>
	
	<entry key="insertNewAttachment">
		INSERT INTO ATTACHMENT(FILE_NO, REF_BNO, ORIGIN_NAME, CHANGE_NAME,FILE_PATH)
		VALUES(SEQ_FNO.NEXTVAL , ? , ? , ?, ? )
	</entry>
	
	<entry key="insertReply">
		INSERT INTO REPLY(REPLY_NO, REPLY_CONTENT, REF_BNO, REPLY_WRITER)
		VALUES (SEQ_RNO.NEXTVAL, ?, ?, ?)		
	</entry>
	
	<entry key="selectReplyList">
		SELECT 
			REPLY_NO, 
			REPLY_CONTENT, 
			USER_ID,
			 TO_CHAR(CREATE_DATE, 'YY/MM/DD HH:MI:SS' ) AS CREATE_DATE
		FROM REPLY R
		JOIN MEMBER ON (USER_NO = REPLY_WRITER)
		WHERE R.STATUS = 'Y' AND REF_BNO = ?
		ORDER BY CREATE_DATE DESC, REPLY_NO DESC
	</entry>
	
	<entry key="insertBoard">
		INSERT INTO BOARD(BOARD_NO, BOARD_TYPE, REF_UNO, BOARD_TITLE, BOARD_CONTENT, REF_CNO)
		VALUES (SEQ_BNO.NEXTVAL, ?, ? ,? ,?)
	</entry>
	
	<entry key="insertAttachment">
		INSERT INTO ATTACHMENT(FILE_NO, REF_BNO, ORIGIN_NAME, CHANGE_NAME, FILE_PATH, FILE_LEVEL)
		VALUES(SEQ_ANO.NEXTVAL , SEQ_BNO.CURRVAL, ? , ?, ?, ?)
	</entry>
</properties>